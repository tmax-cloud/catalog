apiVersion: tmax.io/v1
kind: ClusterTemplate
metadata:
  name: java-s2b-template
categories:
- source2build
- java
- maven
- gradle
imageUrl: ""
urlDescription: ""
longDescription: ""
markdownDescription: ""
objectKinds:
- Deployment
objects:
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    name: ${POD_NAME}
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: java-s2b
    template:
      metadata:
        labels:
          app: java-s2b
      spec:
        containers:
        - name: java-s2b-container
          image: tmaxcloudck/source2build:v3.0
          imagePullPolicy: IfNotPresent
          env:
          - name: GIT_REPO
            value: ${GIT_REPO}
          - name: USR_SECRET_NAME
            valueFrom:
              secretKeyRef:
                name: ${USR_SECRET_NAME}
                key: git-token
          - name: GITHUB_ID
            value: ${GITHUB_ID}
          - name: GITLAB_TOKEN_NAME
            value: ${GITLAB_TOKEN_NAME}
          - name: USR_BUILD_CMD
            value: ${USR_BUILD_CMD}
          - name: USR_RUN_CMD
            value: ${USR_RUN_CMD}

parameters:
- description: pod name
  displayName: POD_NAME
  name: POD_NAME
  required: true
  value: java-s2b-pod
  valueType: string
- description: git repository
  displayName: GIT_REPO
  name: GIT_REPO
  required: true
  valueType: string
- description: secret name containing git token for a private repository
  displayName: USR_SECRET_NAME
  name: USR_SECRET_NAME
  required: false
  value: ""
  valueType: string
- description: github user id for a private repository
  displayname: GITHUB_ID
  name: GITHUB_ID
  required: false
  value: ""
- description: gitlab token name for a private project
  displayname: GITLAB_TOKEN_NAME
  name: GITLAB_TOKEN_NAME
  required: false
  value: ""
- description: user build command
  displayName: USR_BUILD_CMD
  name: USR_BUILD_CMD
  required: true
  valueType: string
- description: user run command
  displayName: USR_RUN_CMD
  name: USR_RUN_CMD
  required: true
  valueType: string


